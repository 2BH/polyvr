#version 400 compatibility
#extension GL_ARB_tessellation_shader : enable

layout(vertices = 2) out;
out vec3 tcPosition[];
in vec2 vtc[];
out vec2 ctc[];
in vec3 vn[];
out vec3 cn[];

#define ID gl_InvocationID

void main() {
    tcPosition[ID] = gl_in[ID].gl_Position.xyz;
    ctc[ID] = vtc[ID];
    cn[ID] = vn[ID];
    
    if (ID == 0) {
	vec4 p = gl_ModelViewProjectionMatrix * gl_in[ID].gl_Position;
	float d = length(p.xyz);
        gl_TessLevelOuter[0] = 1;
        gl_TessLevelOuter[1] = 1;
        if (d < 15) gl_TessLevelOuter[1] = 3;
        if (d < 5) gl_TessLevelOuter[1] = 6;
    }
}
